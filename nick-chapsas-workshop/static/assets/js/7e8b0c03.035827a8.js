"use strict";(self.webpackChunktesting_workshop=self.webpackChunktesting_workshop||[]).push([[4133],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),g=c(n),h=i,d=g["".concat(l,".").concat(h)]||g[h]||u[h]||o;return n?r.createElement(d,s(s({ref:t},p),{},{components:n})):r.createElement(d,s({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,s=new Array(o);s[0]=g;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a.mdxType="string"==typeof e?e:i,s[1]=a;for(var c=2;c<o;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},921:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var r=n(7462),i=(n(7294),n(3905));const o={description:"Let's setup our test suite for UI testing"},s="Bootstrapping our tests",a={unversionedId:"integration-testing/ui/test-setup",id:"integration-testing/ui/test-setup",title:"Bootstrapping our tests",description:"Let's setup our test suite for UI testing",source:"@site/docs/integration-testing/ui/test-setup.md",sourceDirName:"integration-testing/ui",slug:"/integration-testing/ui/test-setup",permalink:"/integration-testing/ui/test-setup",draft:!1,tags:[],version:"current",frontMatter:{description:"Let's setup our test suite for UI testing"},sidebar:"docs",previous:{title:"Running the app for testing",permalink:"/integration-testing/ui/running-for-testing"},next:{title:"Running Docker Compose",permalink:"/integration-testing/ui/dealing-with-docker-compose"}},l={},c=[{value:"The test context",id:"the-test-context",level:2},{value:"The test execution flow",id:"the-test-execution-flow",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"bootstrapping-our-tests"},"Bootstrapping our tests"),(0,i.kt)("h2",{id:"the-test-context"},"The test context"),(0,i.kt)("p",null,"Since we will be dealing with Docker, the fake GitHub API and the tool that will be making browser actions in our tests,\nwe need to build a class that will contain all that logic. In the API testing section we had the WebApplicationFactory.\nFor our Web App testing we will have the ",(0,i.kt)("inlineCode",{parentName:"p"},"TestingContext"),". It will largely play a similar role in terms of starting and stopping Docker components and the GitHub API as well as the in-memory browser."),(0,i.kt)("p",null,"Let's create this class and for now only include the WireMock.NET Server."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},"public class TestingContext : IAsyncLifetime\n{\n    public GitHubApiServer GitHubApiServer { get; } = new();\n\n    public async Task InitializeAsync()\n    {\n        GitHubApiServer.Start(9850);\n    }\n\n    public async Task DisposeAsync()\n    {\n        GitHubApiServer.Dispose();\n    }\n}\n")),(0,i.kt)("p",null,"As you can see we are still following the same ",(0,i.kt)("inlineCode",{parentName:"p"},"IAsyncLifetime")," approach to have things happen during test startup and teardown.\nThe only difference with our previous approach is that the ",(0,i.kt)("inlineCode",{parentName:"p"},"GitHubApiServer")," accepts a port as part of the ",(0,i.kt)("inlineCode",{parentName:"p"},"Start")," method to ensure that the server starts on the same port every time."),(0,i.kt)("h2",{id:"the-test-execution-flow"},"The test execution flow"),(0,i.kt)("p",null,"Because we will be doing UI testing, it will be significantly easier to run our tests sequentially.\nThis prevents any potential clashes that could make our life harder. It is possible to run those tests in parallel but you need to be very careful with preventing database-level clashes."),(0,i.kt)("p",null,"To ensure that tests will be running sequentially even on separate classes we will need to create a Collection Fixture."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},'[CollectionDefinition("Test collection")]\npublic class SharedTestCollection : ICollectionFixture<TestingContext>\n{\n    \n}\n')),(0,i.kt)("p",null,"This is all we need this class to contain. It acts as a marker and we passed the ",(0,i.kt)("inlineCode",{parentName:"p"},"TestingContext")," class as a parameter to ensure that it is reused between all tests."),(0,i.kt)("p",null,"Now we simply decorate our test classes with ",(0,i.kt)("inlineCode",{parentName:"p"},'[Collection("Test collection")]')," and we can inject the ",(0,i.kt)("inlineCode",{parentName:"p"},"TestingContext")," class in the constructor."),(0,i.kt)("p",null,"This is what the ",(0,i.kt)("inlineCode",{parentName:"p"},"CreateCustomerTests.cs")," class containing our tests for creating a customer will look like to start with:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},'[Collection("Test collection")]\npublic class CreateCustomerTests\n{\n    private readonly SharedTestContext _testContext;    \n\n    public CreateCustomerTests(SharedTestContext testContext)\n    {\n        _testContext = testContext;\n    }    \n}\n')),(0,i.kt)("p",null,"We are now ready to introduce the new way of running Docker Compose for testing."))}u.isMDXComponent=!0}}]);